"use strict";(self["webpackChunkinefi_cli"]=self["webpackChunkinefi_cli"]||[]).push([[750],{8584:function(e,l,t){t.d(l,{Z:function(){return u}});var s=t(6252),a=t(3577);const o={class:"card-component"},c={key:0,class:"title mb-2 fw-bold"};var i={__name:"CardComponent",props:{title:{type:[String,Boolean],default:!1}},setup(e){return(l,t)=>((0,s.wg)(),(0,s.iD)("div",o,[e.title?((0,s.wg)(),(0,s.iD)("div",c,(0,a.zw)(e.title),1)):(0,s.kq)("",!0),(0,s.WI)(l.$slots,"content")]))}};const n=i;var u=n},5750:function(e,l,t){t.r(l),t.d(l,{default:function(){return se}});t(560);var s=t(6252),a=t(3577),o=t(2262),c=t(8584),i=t(5781),n=t(5121),u=t(2201),r=t(3907);const d={class:"layout-content px-4 py-3"},v=(0,s._)("p",{class:"mb-2"},"被刪除的群組",-1),m={class:"header py-3 d-flex justify-content-between align-items-center"},p={class:"title d-flex align-items-center"},g=(0,s._)("h3",{class:"mb-0 me-3 fw-bold"},"群組健康度",-1),w={class:"layout-content"},f={class:"row m-0"},h={class:"health_outer_layout d-flex"},_={class:"row flex-grow-1 ps-2 pb-2"},k={class:"col-12 col-xxl-2 mb-4 ms-2 ps-xxl-3 m-xxl-0"},x={class:"row h-100 flex-wrap"},D={class:"col-6 col-md-4 col-xxl-12"},b={class:"h-100 d-flex align-items-center"},S={class:"col-6 col-md-4 col-xxl-12"},y={class:"d-flex align-items-center active_folder h-100"},U={class:"col-12 col-lg-8 col-xl-7 col-xxl-5 device-amount mb-4 mb-lg-0"},H={class:"d-flex flex-column flex-md-row align-items-md-center h-100"},G={class:"total-device align-items-center align-items-md-start align-items-xl-center mb-2 mb-md-0 ms-xl-3 ms-xxl-0"},I=(0,s._)("div",{class:"title"}," 總連線裝置 ",-1),C={class:"amount"},O={class:"device-status justify-content-evenly p-1 p-lg-2 ms-md-3 ms-xl-5"},W=["onClick"],z=(0,s._)("div",{class:"dot"},null,-1),N={key:0,class:"ms-2"},R={key:1,class:"ms-2"},E={key:2,class:"ms-2"},q={key:3,class:"ms-2"},Y={class:"amount"},V={class:"title fw-bold p-3"},j={class:"layout-content p-3"},K=(0,s._)("div",{class:"row border-b p-2"},[(0,s._)("div",{class:"col-6"}," 名稱 "),(0,s._)("div",{class:"col-6"}," 標籤 ")],-1),P={class:"col-6"},Z={class:"col-6"},A={key:1,class:"p-2 text-center"},$={class:"col-12 col-lg-4 col-xl-5"},B={class:"row align-items-center ps-3 ps-md-0 h-100"},L={class:"col-6 col-md-8 col-lg-12 col-xl-5 mb-lg-4 mb-xl-0"},M={class:"device_health"},T=(0,s._)("h4",{class:"mb-0"}," 群組健康度 ",-1),F={key:0,class:"mt-3 fw-bold"},J={class:"col-6 col-md-4 col-lg-12 col-xl-6"},Q={class:"health_score"},X={key:0,class:"score p-3 ms-3 fw-bold"},ee=(0,s._)("div",{class:"more_oparate px-0 px-xxl-2 justify-content-start justify-content-md-center"},[(0,s._)("div",{class:"icon"},[(0,s._)("span"),(0,s._)("span"),(0,s._)("span")])],-1);var le={__name:"GroupHealthView",setup(e){const l=(0,s.f3)("prefixURL");let t=`${l}/data/group_tree.json`,le="/data/group_health_moniter.json";const te=(0,o.iH)([]);function se(e){return e.forEach((e=>{e.slaveGroupName=e.masterGroupName,e.slaveGroupUUID=e.masterGroupUUID,e.slaveGroupId=e.masterGroupId})),e}n.Z.get(t).then((e=>{let l=e.data;te.value=[...se(l.result)]})).catch((e=>{console.log(e)}));const ae=(0,o.iH)([]);n.Z.get(le).then((e=>{ae.value=e.data.result}));const oe=(0,o.iH)([]),ce=(0,o.iH)([]);function ie(e=[],l=[]){let t=[],s=l.filter((l=>{if(l.subgroup){let s=ie(e,l.subgroup);t.push(...s)}let s=e.some((e=>(e.groupUUID===l.slaveGroupUUID&&(l.titleOfDeviceHealthGroup=e.titleOfDeviceHealthGroup,l.idOfDeviceHealthGroup=e.idOfDeviceHealthGroup),e.groupUUID===l.slaveGroupUUID)));return s}));return t.push(...s),t}(0,s.YP)([ae,te],(([e,l])=>{let t=ie(e,l);oe.value=t}));const ne=(0,o.iH)(!1),ue=(0,o.iH)(!1);function re(){ue.value=!0,ne.value=!1,ce.value.forEach((e=>{console.log(`發送API delete groupUUID: ${e.groupUUID}`)}))}(0,s.YP)(ue,(e=>{e&&(oe.value=ie(ae.value,te.value))}));const de=(0,o.iH)([]);function ve(e=[]){return e.forEach((e=>{if(e.devicesStatus={total:0,good:0,warn:0,error:0,unknown:0},e.devices){let l=e.devices.filter((e=>"REGISTERED"===e.deviceState&&"DISCONNECTED"!==e.healthStatus&&"OOB"!==e.healthStatus&&!0===e.isConnected));0===l.length&&(e.devices=[]);let t=l.filter((e=>"GOOD"===e.healthStatus)),s=l.filter((e=>"WARN"===e.healthStatus)),a=l.filter((e=>"ERROR"===e.healthStatus)),o=l.filter((e=>"UNKNOWN"===e.healthStatus));e.devicesStatus.total=l.length,e.devicesStatus.good=t.length,e.devicesStatus.warn=s.length,e.devicesStatus.error=a.length,e.devicesStatus.unknown=o.length}else e.devices=[]})),e}function me(e){let l=e.good/e.total*100;return l}function pe(e){let l=me(e),t="";return l>70?t="GOOD":l<70&&l>30?t="WARNING":l<30&&(t="ERROR"),t}(0,s.YP)(oe,(e=>{de.value=ve(e)}));const ge=(0,o.iH)(""),we=(0,o.iH)([]),fe=(0,o.iH)(!1),he=(e,l=[])=>{fe.value=!0;let t=l.filter((l=>l.healthStatus===e.toUpperCase()));we.value=t,"good"===e?ge.value="良好":"warn"===e?ge.value="警告":"error"===e?ge.value="錯誤":"unknown"===e&&(ge.value="未知")},_e=(0,u.tv)(),ke=(0,r.oR)();function xe(e){ke.commit("groupHealth/setCheckSlaveGroupId",e),_e.path="/deviceManagement/group"}return(e,l)=>{const t=(0,s.up)("el-button"),n=(0,s.up)("el-dialog"),u=(0,s.up)("font-awesome-icon"),r=(0,s.up)("router-link"),le=(0,s.up)("el-scrollbar");return(0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(n,{modelValue:ne.value,"onUpdate:modelValue":l[0]||(l[0]=e=>ne.value=e),width:"200px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"align-center":!0},{header:(0,s.w5)((()=>[v])),footer:(0,s.w5)((()=>[(0,s.Wm)(t,{type:"info",onClick:re},{default:(0,s.w5)((()=>[(0,s.Uk)(" 確認 ")])),_:1})])),default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(ce.value,(e=>((0,s.wg)(),(0,s.iD)("p",{class:"mb-2",key:e.groupUUID},(0,a.zw)(e.titleOfDeviceHealthGroup),1)))),128))])),_:1},8,["modelValue"]),(0,s._)("div",m,[(0,s._)("div",p,[g,(0,s.Wm)(t,{icon:(0,o.SU)(i.Refresh),size:"large",circle:""},null,8,["icon"])])]),(0,s._)("div",w,[(0,s.Wm)(le,null,{default:(0,s.w5)((()=>[(0,s._)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(de.value,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"col-12 mt-3",key:e.slaveGroupId},[(0,s.Wm)(c.Z,{class:"p-3 w-100"},{content:(0,s.w5)((()=>[(0,s._)("div",h,[(0,s._)("div",_,[(0,s._)("div",k,[(0,s._)("div",x,[(0,s._)("div",D,[(0,s._)("div",b,(0,a.zw)(e.titleOfDeviceHealthGroup),1)]),(0,s._)("div",S,[(0,s._)("div",y,[(0,s.Wm)(u,{icon:"fa-solid fa-folder"}),(0,s.Wm)(r,{to:"/deviceManagement/group",class:"ms-2 highLight",onClick:l=>xe(e)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.slaveGroupName),1)])),_:2},1032,["onClick"])])])])]),(0,s._)("div",U,[(0,s._)("div",H,[(0,s._)("div",G,[I,(0,s._)("div",C,(0,a.zw)(e.devicesStatus.total),1)]),(0,s._)("div",O,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.devicesStatus,((l,t)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:l},["total"!==t?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"status p-2",onClick:l=>he(t,e.devices)},[(0,s._)("div",{class:(0,a.C_)(["status_name mb-2",[{good:"good"===t},{warn:"warn"===t},{error:"error"===t},{unknown:"unknown"===t}]])},[z,"good"===t?((0,s.wg)(),(0,s.iD)("span",N,"良好")):(0,s.kq)("",!0),"warn"===t?((0,s.wg)(),(0,s.iD)("span",R,"警告")):(0,s.kq)("",!0),"error"===t?((0,s.wg)(),(0,s.iD)("span",E,"錯誤")):(0,s.kq)("",!0),"unknown"===t?((0,s.wg)(),(0,s.iD)("span",q,"未知")):(0,s.kq)("",!0)],2),(0,s._)("div",Y,(0,a.zw)(l),1)],8,W)):(0,s.kq)("",!0)],64)))),128)),(0,s.Wm)(n,{modelValue:fe.value,"onUpdate:modelValue":l[2]||(l[2]=e=>fe.value=e),width:"400px","align-center":!0,class:"pop_message","show-close":!1},{header:(0,s.w5)((()=>[(0,s._)("div",V,(0,a.zw)(ge.value),1)])),footer:(0,s.w5)((()=>[(0,s.Wm)(t,{type:"info",onClick:l[1]||(l[1]=e=>fe.value=!1)},{default:(0,s.w5)((()=>[(0,s.Uk)("關閉")])),_:1})])),default:(0,s.w5)((()=>[(0,s._)("div",j,[K,we.value.length?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(we.value,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"row border-b p-2",key:e.nodeId},[(0,s._)("div",P,(0,a.zw)(e.deviceName),1),(0,s._)("div",Z,(0,a.zw)(e.aliasName),1)])))),128)):0===we.value.length?((0,s.wg)(),(0,s.iD)("div",A," 無裝置資料 ")):(0,s.kq)("",!0)])])),_:1},8,["modelValue"])])])]),(0,s._)("div",$,[(0,s._)("div",B,[(0,s._)("div",L,[(0,s._)("div",M,[T,0===e.devices.length?((0,s.wg)(),(0,s.iD)("span",F," 沒有裝置 ")):e.devices.length?((0,s.wg)(),(0,s.iD)("span",{key:1,class:(0,a.C_)(["mt-3 fw-bold",[{good:me(e.devicesStatus)>70},{warn:me(e.devicesStatus)<70&&me(e.devicesStatus)>30},{error:me(e.devicesStatus)<30}]])},(0,a.zw)(pe(e.devicesStatus)),3)):(0,s.kq)("",!0)])]),(0,s._)("div",J,[(0,s._)("div",Q,[(0,s.Wm)(u,{icon:"fa-solid fa-folder",size:"2xl"}),0===e.devices.length?((0,s.wg)(),(0,s.iD)("div",X," 沒有裝置 ")):e.devices.length?((0,s.wg)(),(0,s.iD)("div",{key:1,class:(0,a.C_)(["score number p-3 ms-3 fw-bold",[{good:me(e.devicesStatus)>70},{warn:me(e.devicesStatus)<70&&me(e.devicesStatus)>30},{error:me(e.devicesStatus)<30}]])},(0,a.zw)(me(e.devicesStatus))+"% ",3)):(0,s.kq)("",!0)])])])])]),ee])])),_:2},1024)])))),128))])])),_:1})])])}}};const te=le;var se=te}}]);
//# sourceMappingURL=750.b013e2b3.js.map